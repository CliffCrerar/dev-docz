<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../assets/style.css?t=90051322">
    <link rel="stylesheet" href="../_assets/css/style.css?t=5b65582b">
    <script src="../assets/script.js?t=93f1a66c"></script>
    <script src="../_assets/scripts/scripts.js?t=f4709986"></script>
    <script src="https://cdn-cloudflare.ga/assets/jquery/min.js"></script>
    <title>Google Dev Stuff - DEV DOCS</title>
    <meta name="viewport" content="width=device-width">
  </head>
  <body class="-menu-visible">
    <div class="doc-layout">
      <div class="toggle menu-toggle js-menu-toggle"></div>
      <div class="menu toc-menu">
        <ul>
          <li class="menu-item -level-0 -parent">
            <ul class="submenu">
              <li class="menu-item -level-1"><a class="link title  link-index" href="../index.html">DEV DOCS</a>
              </li>
              <li class="menu-item -level-1"><a class="link title  link-about" href="../about/index.html">About</a>
              </li>
              <li class="menu-item -level-1"><a class="link title  link-mail" href="../mail/index.html">Mail server tools</a>
              </li>
              <li class="menu-item -level-1"><a class="link title -active link-google" href="../google/index.html">Google Dev Stuff</a>
                <ul class="headings heading-list">
                  <li class="heading-item -depth-2"><a class="hlink link-logging" href="#logging">Logging</a>
                  </li>
                  <li class="heading-item -depth-2"><a class="hlink link-ui-webapp" href="#ui-webapp">UI Webapp</a>
                  </li>
                  <li class="heading-item -depth-2"><a class="hlink link-printing-scriplets" href="#printing-scriplets">Printing scriplets</a>
                  </li>
                  <li class="heading-item -depth-2"><a class="hlink link-forms" href="#forms">forms</a>
                  </li>
                </ul>
              </li>
              <li class="menu-item -level-1"><a class="link title  link-devdocsio" href="../devdocsio/index.html">Devdocs.io</a>
              </li>
              <li class="menu-item -level-1"><a class="link title  link-markdown" href="../markdown/index.html">Markdown</a>
              </li>
              <li class="menu-item -level-1 -parent"><a class="link title  link-aws" href="../aws/index.html">AWS Resources</a>
                <ul class="submenu">
                  <li class="menu-item -level-2"><a class="link title  link-awsinfo-resources" href="../aws/info-resources.html">Info</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-awspartner-resources" href="../aws/partner-resources.html">Partner</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-awstraining-resources" href="../aws/training-resources.html">Training</a>
                  </li>
                </ul>
              </li>
              <li class="menu-item -level-1"><a class="link title  link-azure" href="../azure/index.html">Azure Cloud</a>
              </li>
              <li class="menu-item -level-1"><a class="link title  link-exercise" href="../exercise/index.html">Saved Exercises</a>
              </li>
              <li class="menu-item -level-1"><a class="link title  link-exp" href="../exp/index.html">Application</a>
              </li>
              <li class="menu-item -level-1"><a class="link title  link-serverless-phemonic" href="../serverless-phemonic/index.html">Serverless with Phemonic.io</a>
              </li>
              <li class="menu-item -level-1 -parent"><a class="link title  link-dev-resources" href="../dev-resources/index.html">Dev Resources</a>
                <ul class="submenu">
                  <li class="menu-item -level-2"><a class="link title  link-dev-resourceseslint-rules" href="../dev-resources/eslint-rules.html">Eslint Rules</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-dev-resourceshugo-themes" href="../dev-resources/hugo-themes.html">Hugo Themes</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-dev-resourcesfreenom-api" href="../dev-resources/freenom-api.html">Freenom API</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-dev-resourcescloud-flare-wrangler" href="../dev-resources/cloud-flare-wrangler.html">Cloud Flare API</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-dev-resourcescloud-flare-wrangler-2" href="../dev-resources/cloud-flare-wrangler.html">Cloud Flare Wrangler</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-dev-resourcescloud-flare-wrangler-conf" href="../dev-resources/cloud-flare-wrangler-conf.html">Configure</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-dev-resourcesserverlesscom" href="../dev-resources/serverless.com.html">Serverless org</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-dev-resourceshubot" href="../dev-resources/hubot.html">Hubot generator</a>
                  </li>
                </ul>
              </li>
              <li class="menu-item -level-1 -parent"><a class="link title  link-databases" href="../databases/index.html">Data &amp; Databases</a>
                <ul class="submenu">
                  <li class="menu-item -level-2"><a class="link title  link-databasesgraphql" href="../databases/graphql.html">GraphQL</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-databasesnosql" href="../databases/noSQL.html">NoSQL</a>
                  </li>
                  <li class="menu-item -level-2"><a class="link title  link-databasessql" href="../databases/sql.html">SQL</a>
                  </li>
                </ul>
              </li>
              <li class="menu-item -level-1 -parent"><a class="link title  link-policies" href="../policies/index.html">Policies</a>
                <ul class="submenu">
                  <li class="menu-item -level-2"><a class="link title  link-policiesacceptable-use-policy" href="../policies/acceptable-use-policy.html">Acceptable Use Policies</a>
                  </li>
                </ul>
              </li>
              <li class="menu-item -level-1"><a class="link title  link-resources" href="../resources/index.html">Resources</a>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="body page-google">
        <div class="header-nav">
          <div class="right"><a class="iconlink" href="https://github.com/CliffCrerar/dev-docz" data-title="CliffCrerar/dev-docz">
              <!-- span.title Open in GitHub--><span class="icon -github"></span></a>
          </div>
        </div>
        <div class="markdown-body"><h1 id="google-dev-stuff">Google Dev stuff</h1>
<p>Developer resources related to Google and the google cloud.</p>
<h1 id="g-script">G script</h1>
<p><a href="https://www.freecodecamp.org/news/use-google-sheets-and-google-apps-script-to-build-a-blog-cms-c2eab3fb0b2b/">https://www.freecodecamp.org/news/use-google-sheets-and-google-apps-script-to-build-a-blog-cms-c2eab3fb0b2b/</a></p>
<p>&quot;<a href="https://codelabs.developers.google.com/codelabs/apps-script-intro/#0">https://codelabs.developers.google.com/codelabs/apps-script-intro/#0</a>&quot;</p>
<p>&quot;<a href="https://support.office.com/en-us/article/connect-to-a-web-page-power-query-b2725d67-c9e8-43e6-a590-c0a175bd64d8">https://support.office.com/en-us/article/connect-to-a-web-page-power-query-b2725d67-c9e8-43e6-a590-c0a175bd64d8</a>&quot;</p>
<p>&quot;<a href="https://developers.google.com/apps-script/guides/videos">https://developers.google.com/apps-script/guides/videos</a>&quot;</p>
<p><a href="https://github.com/GoogleCloudPlatform/google-cloud-node-todos">https://github.com/GoogleCloudPlatform/google-cloud-node-todos</a></p>
<p><a href="https://github.com/sebelga/gstore-api">https://github.com/sebelga/gstore-api</a></p>
<p><a href="https://github.com/sebelga/gstore-node">https://github.com/sebelga/gstore-node</a></p>
<p><a href="https://github.com/googleapis/google-cloud-kvstore">https://github.com/googleapis/google-cloud-kvstore</a></p>
<p><a href="https://googleapis.dev/nodejs/googleapis/latest/">https://googleapis.dev/nodejs/googleapis/latest/</a></p>
<h2 id="logging">Logging</h2>
<p><a href="http://logging.gs">logging.gs</a></p>
<pre><code class="lang-js"><span class="pl-c">// [START apps_script_logging]</span>
<span class="pl-c">/**
 * Logs the time taken to execute &apos;myFunction&apos;.
 */</span>
<span class="hljs-function"><span class="pl-k">function</span> <span class="pl-ent">measuringExecutionTime</span>(<span class="hljs-params"></span>) </span>{
  <span class="pl-c">// A simple INFO log message, using sprintf() formatting.</span>
  <span class="pl-c1">console</span>.info(<span class="pl-s">&apos;Timing the %s function (%d arguments)&apos;</span>, <span class="pl-s">&apos;myFunction&apos;</span>, <span class="hljs-number">1</span>);

  <span class="pl-c">// Log a JSON object at a DEBUG level. The log is labeled</span>
  <span class="pl-c">// with the message string in the log viewer, and the JSON content</span>
  <span class="pl-c">// is displayed in the expanded log structure under &quot;structPayload&quot;.</span>
  <span class="pl-k">var</span> parameters = {
      <span class="hljs-attr">isValid</span>: <span class="pl-c1">true</span>,
      <span class="hljs-attr">content</span>: <span class="pl-s">&apos;some string&apos;</span>,
      <span class="hljs-attr">timestamp</span>: <span class="pl-k">new</span> <span class="pl-c1">Date</span>()
  };
  <span class="pl-c1">console</span>.log({<span class="hljs-attr">message</span>: <span class="pl-s">&apos;Function Input&apos;</span>, <span class="hljs-attr">initialData</span>: parameters});

  <span class="pl-k">var</span> label = <span class="pl-s">&apos;myFunction() time&apos;</span>; <span class="pl-c">// Labels the timing log entry.</span>
  <span class="pl-c1">console</span>.time(label); <span class="pl-c">// Starts the timer.</span>
  <span class="pl-k">try</span> {
    myFunction(parameters); <span class="pl-c">// Function to time.</span>
  } <span class="pl-k">catch</span> (e) {
    <span class="pl-c">// Logs an ERROR message.</span>
    <span class="pl-c1">console</span>.error(<span class="pl-s">&apos;myFunction() yielded an error: &apos;</span> + e);
  }
  <span class="pl-c1">console</span>.timeEnd(label); <span class="pl-c">// Stops the timer, logs execution duration.</span>
}
<span class="pl-c">// [END apps_script_logging]</span>

<span class="pl-c">// [START apps_script_logging_2]</span>
<span class="pl-c">/**
 * Logs Google Sheet information.
 * @param {number} rowNumber The spreadsheet row number.
 * @param {string} email The email to send with the row data.
 */</span>
<span class="hljs-function"><span class="pl-k">function</span> <span class="pl-ent">emailDataRow</span>(<span class="hljs-params">rowNumber, email</span>) </span>{
  Logger.log(<span class="pl-s">&apos;Emailing data row &apos;</span> + rowNumber + <span class="pl-s">&apos; to &apos;</span> + email);
  <span class="pl-k">var</span> sheet = SpreadsheetApp.getActiveSheet();
  <span class="pl-k">var</span> data = sheet.getDataRange().getValues();
  <span class="pl-k">var</span> rowData = data[rowNumber<span class="hljs-number">-1</span>].join(<span class="pl-s">&quot; &quot;</span>);
  Logger.log(<span class="pl-s">&apos;Row &apos;</span> + rowNumber + <span class="pl-s">&apos; data: &apos;</span> + rowData);
  MailApp.sendEmail(email,
                    <span class="pl-s">&apos;Data in row &apos;</span> + rowNumber,
                    rowData);
}
<span class="pl-c">// [END apps_script_logging_2]</span>
</code></pre>
<h2 id="ui-webapp">UI Webapp</h2>
<p><a href="http://code.gs">code.gs</a></p>
<pre><code class="lang-js"><span class="hljs-function"><span class="pl-k">function</span> <span class="pl-ent">doGet</span>(<span class="hljs-params"></span>) </span>{
  <span class="pl-k">return</span> HtmlService.createHtmlOutputFromFile(<span class="pl-s">&apos;Index&apos;</span>);
}
</code></pre>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">target</span>=<span class="pl-s">&quot;_top&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    Hello, World!
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h1 id="ui-sidebar">UI Sidebar</h1>
<p><a href="http://code.gs">code.gs</a></p>
<pre><code class="lang-js"><span class="pl-c">// Use this code for Google Docs, Slides, Forms, or Sheets.</span>
<span class="hljs-function"><span class="pl-k">function</span> <span class="pl-ent">onOpen</span>(<span class="hljs-params"></span>) </span>{
  SpreadsheetApp.getUi() <span class="pl-c">// Or DocumentApp or SlidesApp or FormApp.</span>
      .createMenu(<span class="pl-s">&apos;Dialog&apos;</span>)
      .addItem(<span class="pl-s">&apos;Open&apos;</span>, <span class="pl-s">&apos;openDialog&apos;</span>)
      .addToUi();
}

<span class="hljs-function"><span class="pl-k">function</span> <span class="pl-ent">openDialog</span>(<span class="hljs-params"></span>) </span>{
  <span class="pl-k">var</span> html = HtmlService.createHtmlOutputFromFile(<span class="pl-s">&apos;Index&apos;</span>);
  SpreadsheetApp.getUi() <span class="pl-c">// Or DocumentApp or SlidesApp or FormApp.</span>
      .showModalDialog(html, <span class="pl-s">&apos;Dialog title&apos;</span>);
}
</code></pre>
<p>index.html</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">target</span>=<span class="pl-s">&quot;_top&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    Hello, World!
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="pl-s">&quot;button&quot;</span> <span class="hljs-attr">value</span>=<span class="pl-s">&quot;Close&quot;</span>
        <span class="hljs-attr">onclick</span>=<span class="pl-s">&quot;google.script.host.close()&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>

</code></pre>
<h2 id="printing-scriplets">Printing scriplets</h2>
<p>scriptlet.html</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">target</span>=<span class="pl-s">&quot;_top&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    Hello, World! The time is <span class="php"><span class="hljs-meta">&lt;?</span>= <span class="pl-k">new</span> Date() <span class="hljs-meta">?&gt;</span></span>.
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>standard_scriptlet.html</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">target</span>=<span class="pl-s">&quot;_top&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="php"><span class="hljs-meta">&lt;?</span>= <span class="pl-s">&apos;My favorite Google products:&apos;</span> <span class="hljs-meta">?&gt;</span></span>
    <span class="php"><span class="hljs-meta">&lt;?</span> <span class="pl-k">var</span> data = [<span class="pl-s">&apos;Gmail&apos;</span>, <span class="pl-s">&apos;Docs&apos;</span>, <span class="pl-s">&apos;Android&apos;</span>];
      <span class="pl-k">for</span> (<span class="pl-k">var</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) { <span class="hljs-meta">?&gt;</span></span>
        <span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= data[i] <span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>
    <span class="php"><span class="hljs-meta">&lt;?</span> } <span class="hljs-meta">?&gt;</span></span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 id="forms">forms</h2>
<p>index.html</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">target</span>=<span class="pl-s">&quot;_top&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="pl-c">// Prevent forms from submitting.</span>
      <span class="hljs-function"><span class="pl-k">function</span> <span class="pl-ent">preventFormSubmit</span>(<span class="hljs-params"></span>) </span>{
        <span class="pl-k">var</span> forms = <span class="pl-c1">document</span>.querySelectorAll(<span class="pl-s">&apos;form&apos;</span>);
        <span class="pl-k">for</span> (<span class="pl-k">var</span> i = <span class="hljs-number">0</span>; i &lt; forms.length; i++) {
          forms[i].addEventListener(<span class="pl-s">&apos;submit&apos;</span>, <span class="hljs-function"><span class="pl-k">function</span>(<span class="hljs-params">event</span>) </span>{
            event.preventDefault();
          });
        }
      }
      <span class="pl-c1">window</span>.addEventListener(<span class="pl-s">&apos;load&apos;</span>, preventFormSubmit);

      <span class="hljs-function"><span class="pl-k">function</span> <span class="pl-ent">handleFormSubmit</span>(<span class="hljs-params">formObject</span>) </span>{
        google.script.run.withSuccessHandler(updateUrl).processForm(formObject);
      }
      <span class="hljs-function"><span class="pl-k">function</span> <span class="pl-ent">updateUrl</span>(<span class="hljs-params">url</span>) </span>{
        <span class="pl-k">var</span> div = <span class="pl-c1">document</span>.getElementById(<span class="pl-s">&apos;output&apos;</span>);
        div.innerHTML = <span class="pl-s">&apos;&lt;a href=&quot;&apos;</span> + url + <span class="pl-s">&apos;&quot;&gt;Got it!&lt;/a&gt;&apos;</span>;
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="pl-s">&quot;myForm&quot;</span> <span class="hljs-attr">onsubmit</span>=<span class="pl-s">&quot;handleFormSubmit(this)&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="pl-s">&quot;myFile&quot;</span> <span class="hljs-attr">type</span>=<span class="pl-s">&quot;file&quot;</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="pl-s">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="pl-s">&quot;Submit&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="pl-s">&quot;output&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><a href="http://code.gs">code.gs</a></p>
<pre><code class="lang-js">function doGet() {
  return HtmlService.createHtmlOutputFromFile(&apos;Index&apos;);
}

function processForm(formObject) {
  var formBlob = formObject.myFile;
  var driveFile = DriveApp.createFile(formBlob);
  return driveFile.getUrl();
}
``

## Dialogs

index.html

```html
</code></pre>
<p><a href="http://dialogs.gs">dialogs.gs</a></p>
<pre><code class="lang-js"></code></pre>
<p><a href="http://menu.gs">menu.gs</a></p>
<pre><code class="lang-js"></code></pre>
<p>page.html</p>
<pre><code class="lang-js"></code></pre>

        </div>
        <div class="footer-nav">
          <div class="left"><a href="../mail/index.html"><span class="title">Mail server tools</span></a></div>
          <div class="right"><a href="../devdocsio/index.html"><span class="label">Next: </span><span class="title">Devdocs.io</span></a></div>
        </div>
      </div>
    </div>
  </body>
</html>